From 16de4102f081d0eb2d6c1ce355a3d0e2660d741c Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jan=20Pokorn=C3=BD?= <jpokorny@redhat.com>
Date: Thu, 17 Jan 2013 12:18:47 +0100
Subject: [PATCH 1/2] bz896244 (1/2): default syslog facility is "local4", not
 "daemon"
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Resolves: rhbz#896244

Signed-off-by: Jan Pokorn√Ω <jpokorny@redhat.com>
---
 luci/lib/ClusterConf/Logging.py |  8 ++---
 luci/templates/configure.html   | 72 ++++++++++++++++++++---------------------
 2 files changed, 40 insertions(+), 40 deletions(-)

diff --git a/luci/lib/ClusterConf/Logging.py b/luci/lib/ClusterConf/Logging.py
index 0f11928..e6d7284 100644
--- a/luci/lib/ClusterConf/Logging.py
+++ b/luci/lib/ClusterConf/Logging.py
@@ -1,4 +1,4 @@
-# Copyright (C) 2010-2011 Red Hat, Inc.
+# Copyright 2013 Red Hat, Inc.
 #
 # This program is free software; you can redistribute
 # it and/or modify it under the terms of version 2 of the
@@ -8,7 +8,7 @@
 from TagObject import TagObject
 
 TAG_NAME = 'logging'
-    
+
 syslog_priority_dict = {
     0: 'emerg',
     1: 'alert',
@@ -24,7 +24,7 @@ class Logging(TagObject):
   DEFAULTS = {
     'to_syslog':        '1',
     'to_logfile':       '1',
-    'syslog_facility':  'daemon',
+    'syslog_facility':  'local4',
     'syslog_priority':  'info',
     'logfile_priority': 'info',
   }
@@ -57,10 +57,10 @@ class Logging(TagObject):
 
   def setLogfilePath(self, path):
     return self.addAttribute('logfile', path)
-    
+
   def delLogfilePath(self):
     return self.removeAttribute('logfile')
-    
+
   def getSyslogFacility(self):
     return self.getAttribute('syslog_facility')
 
diff --git a/luci/templates/configure.html b/luci/templates/configure.html
index e23d942..9dfd3a7 100644
--- a/luci/templates/configure.html
+++ b/luci/templates/configure.html
@@ -482,7 +482,7 @@
                       <option value="cron"
                         py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                       <option value="daemon"
-                        py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                        py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                       <option value="kern"
                         py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                       <option value="lpr"
@@ -506,7 +506,7 @@
                       <option value="local3"
                         py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                       <option value="local4"
-                        py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                        py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                       <option value="local5"
                         py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                       <option value="local6"
@@ -599,7 +599,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -623,7 +623,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
@@ -715,7 +715,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -739,7 +739,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
@@ -831,7 +831,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -855,7 +855,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
@@ -947,7 +947,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -971,7 +971,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
@@ -1063,7 +1063,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1087,7 +1087,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1179,7 +1179,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1203,7 +1203,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1295,7 +1295,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1319,7 +1319,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1411,7 +1411,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1435,7 +1435,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1527,7 +1527,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1551,7 +1551,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1643,7 +1643,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1667,7 +1667,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1759,7 +1759,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1783,7 +1783,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1875,7 +1875,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -1899,7 +1899,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -1991,7 +1991,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -2015,7 +2015,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -2107,7 +2107,7 @@
                                   <option value="cron"
                                     py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                                   <option value="daemon"
-                                    py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                                    py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                                   <option value="kern"
                                     py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                                   <option value="lpr"
@@ -2131,7 +2131,7 @@
                                   <option value="local3"
                                     py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                                   <option value="local4"
-                                    py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                                    py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                                   <option value="local5"
                                     py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                                   <option value="local6"
@@ -2225,7 +2225,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -2249,7 +2249,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
@@ -2341,7 +2341,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -2365,7 +2365,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
@@ -2457,7 +2457,7 @@
                           <option value="cron"
                             py:attrs="cur_facility == 'cron' and {'selected':'selected'} or {}">cron</option>
                           <option value="daemon"
-                            py:attrs="(not cur_facility or cur_facility == 'daemon') and {'selected':'selected'} or {}">daemon</option>
+                            py:attrs="cur_facility == 'daemon' and {'selected':'selected'} or {}">daemon</option>
                           <option value="kern"
                             py:attrs="cur_facility == 'kern' and {'selected':'selected'} or {}">kern</option>
                           <option value="lpr"
@@ -2481,7 +2481,7 @@
                           <option value="local3"
                             py:attrs="cur_facility == 'local3' and {'selected':'selected'} or {}">local3</option>
                           <option value="local4"
-                            py:attrs="cur_facility == 'local4' and {'selected':'selected'} or {}">local4</option>
+                            py:attrs="(not cur_facility or cur_facility == 'local4') and {'selected':'selected'} or {}">local4</option>
                           <option value="local5"
                             py:attrs="cur_facility == 'local5' and {'selected':'selected'} or {}">local5</option>
                           <option value="local6"
-- 
1.7.11.7

